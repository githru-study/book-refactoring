# 7.2 컬렉션 캡슐화하기 - Encapsulate Collection

## 요약

컬렉션을 소유한 클래스를 통해서만 원소를 변경하도록 한다.

> 컬렉션: 레코드의 집합

## 배경

컬렉션 변수로의 접근을 캡슐화하면서 게터가 컬렉션 자체를 반환하도록 한다면 그 컬렉션을 감싼 클래스가 눈치채지 못하는 상태에서 컬렉션의 원소들이 바뀌어버릴 수 있다.

## 대상 & 방식

- 절대로 컬렉션 값을 반환하지 않게 한다.
  - `aCustomer.orders.size()`-> `aCustomer.numberOfOrders()`
  - 저자는 동의하지 않는다고 한다.
  - 컬랙션 파이프라인 패턴으로 조합할 수 있기 때문에, 표준 인터페이스 대신 전용 메서드들을 사용하게 하면 부가적인 코드가 상당히 늘어나며 컬렉션 연산들을 조합해 쓰기도 어려워지기 때문
- 읽기전용으로 제공
  - 자바에서는 컬렉션의 읽기전용 프락시를 반환하게 만들기가 쉽다.
- 컬렉션 게터를 제공하되 내부 컬렉션의 복제본을 반환한다.
  - 컬렉션이 상당히 크다면 성능 문제가 발생할 수 있다.
  - 하지만 성능에 지장을 줄만큼 컬렉션이 큰 경우는 별로 없다.

## 절차

1. 컬렉션을 캡슐화하지 않았다면 변수 캡슐화하기부터 한다.
2. 컬렉션에 원소를 추가 / 제거하는 함수를 추가한다.
3. 정적 검사 수행
4. 컬렉션을 참조하는 부분을 모두 찾는다. 컬렉션의 변경자를 호출하는 코드가 모두 앞에서 추가한 추가/제거 함수를 호출하도록 수정한다.
   1. 수정할 때마다 테스트한다.
5. 컬렉션 게터를 수정해서 원본 내용을 수정할 수 없는 읽기전용 프락시나 복제본을 반환하게 한다.

## 예시
